# GuÃ­a de instalaciÃ³n y configuraciÃ³n recomendada para Odoo 16 Community Edition en Ubuntu 20.04 LTS

## ğŸ”§ Requisitos previos

- Ubuntu Server 20.04.6 LTS actualizado
- Acceso root o permisos sudo

## ğŸ§± 1. InstalaciÃ³n de dependencias bÃ¡sicas

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install -y git python3-pip build-essential wget curl python3-dev python3-venv \
  libxslt-dev libzip-dev libldap2-dev libsasl2-dev python3-setuptools node-less \
  libjpeg-dev libpq-dev libffi-dev libtiff-dev libopenjp2-7-dev libxml2-dev libxls-dev \
  zlib1g-dev liblcms2-dev libblas-dev libatlas-base-dev xfonts-75dpi xfonts-base \
  libfreetype6-dev libwebp-dev libharfbuzz-dev libfribidi-dev libxcb1-dev
```

## ğŸ˜ 2. InstalaciÃ³n y configuraciÃ³n de PostgreSQL

```bash
sudo apt install postgresql -y
sudo -u postgres createuser -s odoo
```

## ğŸ‘¤ 3. Crear usuario del sistema y directorios

```bash
sudo adduser --system --home=/opt/odoo --group odoo
sudo mkdir /opt/odoo/custom-addons
sudo chown -R odoo:odoo /opt/odoo
```

## ğŸŒ 4. Clonar cÃ³digo fuente de Odoo 16

```bash
sudo -u odoo git clone https://github.com/odoo/odoo.git /opt/odoo/odoo --depth 1 --branch 16.0
```

## ğŸ“¦ 5. Crear entorno virtual e instalar dependencias

```bash
sudo -u odoo python3 -m venv /opt/odoo/venv
sudo -u odoo -H bash -c "source /opt/odoo/venv/bin/activate && pip install -r /opt/odoo/odoo/requirements.txt"
```

## âš™ï¸ 6. Crear archivo de configuraciÃ³n `odoo.conf`

### ğŸ” 6.1 Verificar capacidades del servidor

```bash
nproc
free -m
```

### ğŸ§® 6.2 FÃ³rmulas recomendadas

- workers = nÃºcleos * 2 + 1
- limit_memory_soft = RAM total * 0.7
- limit_memory_hard = RAM total * 0.8

### ğŸ“ 6.3 Crear archivo `odoo.conf`

```ini
[options]
db_host = False
db_port = False
db_user = odoo
db_password = False
addons_path = /opt/odoo/odoo/addons,/opt/odoo/custom-addons
admin_passwd = cambia_esto
proxy_mode = True
enable_uds = True
logfile = /var/log/odoo/odoo.log
logrotate = True
xmlrpc_port = 8069
longpolling_port = 8072
workers = 17
limit_request = 8192
limit_memory_soft = 12079595520
limit_memory_hard = 13743895347
limit_time_cpu = 60
limit_time_real = 120
```

## ğŸ“‚ 7. Crear carpeta de logs

```bash
sudo mkdir /var/log/odoo
sudo chown odoo:odoo /var/log/odoo
```

## ğŸš€ 8. Crear servicio systemd

```ini
[Unit]
Description=Odoo
Requires=postgresql.service
After=network.target postgresql.service

[Service]
Type=simple
SyslogIdentifier=odoo
PermissionsStartOnly=true
User=odoo
Group=odoo
ExecStart=/opt/odoo/venv/bin/python3 /opt/odoo/odoo/odoo-bin -c /opt/odoo/odoo.conf
Restart=always
RestartSec=5s
StandardOutput=journal+console

[Install]
WantedBy=multi-user.target
```

```bash
sudo systemctl daemon-reexec
sudo systemctl daemon-reload
sudo systemctl enable --now odoo.service
```

## ğŸ” 0. Certificados SSL (previo a configuraciÃ³n de Nginx)

### ğŸ›°ï¸ 0.1 Migrar certificados desde servidor anterior

**En el servidor daÃ±ado:**

```bash
mkdir -p /tmp/ssl_backup
cp /etc/ssl/remesas/remesasjetperu_pe.crt /tmp/ssl_backup/
cp /etc/ssl/remesas/remesasjetperu_pe.key /tmp/ssl_backup/
tar czvf /tmp/certificados_remesas_backup.tar.gz -C /tmp ssl_backup
```

**Desde tu PC local:**

```bash
scp usuario@ip_servidor_daÃ±ado:/tmp/certificados_remesas_backup.tar.gz ~/
scp ~/certificados_remesas_backup.tar.gz usuario@ip_nuevo_servidor:/tmp/
```

**En el nuevo servidor:**

```bash
tar xzvf /tmp/certificados_remesas_backup.tar.gz -C /tmp
sudo mkdir -p /etc/ssl/remesas
sudo mv /tmp/ssl_backup/remesasjetperu_pe.* /etc/ssl/remesas/
sudo chown root:root /etc/ssl/remesas/remesasjetperu_pe.*
sudo chmod 600 /etc/ssl/remesas/remesasjetperu_pe.key
sudo chmod 644 /etc/ssl/remesas/remesasjetperu_pe.crt
rm -rf /tmp/ssl_backup /tmp/certificados_remesas_backup.tar.gz
```

### ğŸ’¾ 0.2 Copia de seguridad desde el nuevo servidor

```bash
sudo tar czvf /tmp/certificados_remesas_backup.tar.gz -C /etc/ssl remesas/
scp usuario@ip_nuevo_servidor:/tmp/certificados_remesas_backup.tar.gz ~/
sudo rm /tmp/certificados_remesas_backup.tar.gz
```

## ğŸŒ 9. ConfiguraciÃ³n de Nginx

(Contenido omitido aquÃ­ por brevedad, se usa configuraciÃ³n funcional validada)

## ğŸ” 10. Script para actualizar addons

```bash
sudo nano /opt/odoo/update_repos.sh
```

```bash
#!/bin/bash
ADDONS_DIR=/opt/odoo/custom-addons
cd "$ADDONS_DIR"
for d in */ ; do
  echo "ğŸ” Actualizando $d"
  cd "$d"
  git pull --rebase
  cd ..
done
```

```bash
sudo chmod +x /opt/odoo/update_repos.sh
```

## ğŸ•˜ 11. Reinicio automÃ¡tico de Odoo con `cron`

```bash
sudo nano /opt/odoo/restart_odoo.sh
```

```bash
#!/bin/bash
echo "[$(date)] Reiniciando Odoo..." >> /var/log/odoo/restart.log
systemctl restart odoo
```

```bash
sudo chmod +x /opt/odoo/restart_odoo.sh
sudo crontab -e
```

Agregar:

```cron
0 3 */3 * * /opt/odoo/restart_odoo.sh
```

## âœï¸ Autor

**Carlos Enrique Paico Zavala**  
ğŸ“ 961824616  
ğŸ“§ EnriqueZav96@gmail.com  
ğŸ’» GitHub: [EnriqueZav96](https://github.com/EnriqueZav96)
